"use strict";(self.webpackChunkcoordinate=self.webpackChunkcoordinate||[]).push([[3106],{33106:(e,t,o)=>{o.d(t,{addOrUpdateResources:()=>c,bg:()=>f,cL:()=>p,fetchResources:()=>n,removeAllResources:()=>i,removeResource:()=>l});var s=o(3825),r=o(50076),a=o(90534);async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;await e.load(o);const s=(0,a.fj)(e.itemUrl,"resources"),{start:r=1,num:n=10,sortOrder:c="asc",sortField:l="resource"}=t,i={query:{start:r,num:n,sortOrder:c,sortField:l,token:e.apiKey},signal:null===o||void 0===o?void 0:o.signal},u=await e.portal.request(s,i);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((t=>{let{created:o,size:s,resource:r}=t;return{created:new Date(o),size:s,resource:e.resourceFromPath(r)}}))}}async function c(e,t,o,s){const n=new Map;for(const{resource:a,content:l,compress:i,access:d}of t){if(!a.hasPath())throw new r.A("portal-item-resource-".concat(o,":invalid-path"),"Resource does not have a valid path");const[e,t]=u(a.path),s="".concat(e,"/").concat(null!==i&&void 0!==i?i:"","/").concat(null!==d&&void 0!==d?d:"");n.has(s)||n.set(s,{prefix:e,compress:i,access:d,files:[]}),n.get(s).files.push({fileName:t,content:l})}await e.load(s);const c=(0,a.fj)(e.userItemUrl,"add"===o?"addResources":"updateResources");for(const{prefix:r,compress:a,access:l,files:i}of n.values()){const t=25;for(let o=0;o<i.length;o+=t){const n=i.slice(o,o+t),u=new FormData;r&&"."!==r&&u.append("resourcesPrefix",r),a&&u.append("compress","true"),l&&u.append("access",l);let d=0;for(const{fileName:e,content:t}of n)u.append("file"+ ++d,t,e);u.append("f","json"),await e.portal.request(c,{method:"post",body:u,signal:null===s||void 0===s?void 0:s.signal})}}}async function l(e,t,o){if(!t.hasPath())throw new r.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(o);const s=(0,a.fj)(e.userItemUrl,"removeResources");await e.portal.request(s,{method:"post",query:{resource:t.path},signal:null===o||void 0===o?void 0:o.signal}),t.portalItem=null}async function i(e,t){await e.load(t);const o=(0,a.fj)(e.userItemUrl,"removeResources");return e.portal.request(o,{method:"post",query:{deleteAll:!0},signal:null===t||void 0===t?void 0:t.signal})}function u(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function d(e){const[t,o]=function(e){const t=(0,a.Zo)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),".".concat(t)]}(e),[s,r]=u(t);return[s,r,o]}async function p(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(await(0,s.A)(e.url,{responseType:"blob"})).data}function f(e,t){if(!e.hasPath())return null;const[o,,s]=d(e.path);return e.portalItem.resourceFromPath((0,a.fj)(o,t+s))}}}]);
//# sourceMappingURL=3106.aad3e8f9.chunk.js.map